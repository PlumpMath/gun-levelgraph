{"version":3,"sources":["save-levelgraph.js"],"names":["createSaveToLvGraph","saveToLvGraph","$saveToLvGraph","addSaveToLvGraph","levelup","require","levelgraph","jsonld","promisify","defaultOpts","dbPath","base","buildOpts","opts","Object","assign","levelDB","lvGraphDb","db","_opts","dbOptions","cb","Error","put","dbGet","get","saveToJsonLd","chain"],"mappings":";;;;;QAmBgBA,mB,GAAAA,mB;QAmBAC,a,GAAAA,a;QAWAC,c,GAAAA,c;QAIAC,gB,GAAAA,gB;AArDhB,IAAMC,UAAUC,QAAQ,SAAR,CAAhB;AACA,IAAMC,aAAaD,QAAQ,YAAR,CAAnB;AACA,IAAME,SAASF,QAAQ,mBAAR,CAAf;AACA,IAAMG,YAAYH,QAAQ,aAAR,CAAlB;;AAEA,IAAMI,cAAc;AAClBC,UAAQ,SADU;AAElBC,QAAM;AAFY,CAApB;;AAKA,SAASC,SAAT,CAAmBC,IAAnB,EAAyB;AACvBA,SAAOC,OAAOC,MAAP,CAAcN,WAAd,EAA2BI,IAA3B,CAAP;;AAEAA,OAAKG,OAAL,GAAeH,KAAKG,OAAL,IAAgBZ,QAAQS,KAAKH,MAAb,CAA/B;AACAG,OAAKI,SAAL,GAAiBJ,KAAKI,SAAL,IAAkBX,WAAWO,KAAKG,OAAhB,CAAnC;AACAH,OAAKK,EAAL,GAAUL,KAAKK,EAAL,IAAWX,OAAOM,KAAKI,SAAZ,EAAuBJ,IAAvB,CAArB;AACA,SAAOA,IAAP;AACD;;AAEM,SAASb,mBAAT,CAA6BmB,KAA7B,EAAoC;AACzC,MAAIC,YAAYR,UAAUO,KAAV,CAAhB;;AAEA,MAAMlB,gBAAgB,SAAhBA,aAAgB,CAAUM,MAAV,EAAkBc,EAAlB,EAAsBR,IAAtB,EAA4B;AAChDA,WAAOC,OAAOC,MAAP,CAAcK,SAAd,EAAyBP,IAAzB,CAAP;AACA,QAAMK,KAAKL,KAAKK,EAAhB;AACA,QAAI,CAACA,EAAL,EAAS;AACP,YAAM,IAAII,KAAJ,CAAU,kCAAV,CAAN;AACD;AACDJ,OAAGX,MAAH,CAAUgB,GAAV,CAAchB,MAAd,EAAsBc,EAAtB,EAA0BR,IAA1B;AACD,GAPD;;AASA,SAAO;AACLW,WAAOJ,UAAUF,EAAV,CAAaX,MAAb,CAAoBkB,GADtB;AAELL,wBAFK;AAGLnB;AAHK,GAAP;AAKD;;AAEM,SAASA,aAAT,CAAuBM,MAAvB,EAA+Bc,EAA/B,EAAmCR,IAAnC,EAAyC;AAC9CA,SAAOC,OAAOC,MAAP,CAAcN,WAAd,EAA2BI,IAA3B,CAAP;AACAA,SAAOD,UAAUC,IAAV,CAAP;;AAEA,MAAMK,KAAKL,KAAKK,EAAhB;AACA,MAAI,CAACA,EAAL,EAAS;AACP,UAAM,IAAII,KAAJ,CAAU,kCAAV,CAAN;AACD;AACDJ,KAAGX,MAAH,CAAUgB,GAAV,CAAchB,MAAd,EAAsBc,EAAtB,EAA0BR,IAA1B;AACD;;AAEM,SAASX,cAAT,CAAwBK,MAAxB,EAAgCc,EAAhC,EAAoCR,IAApC,EAA0C;AAC/C,SAAOL,UAAUkB,YAAV,EAAwBnB,MAAxB,EAAgCM,IAAhC,CAAP;AACD;;AAEM,SAASV,gBAAT,CAA0BwB,KAA1B,EAAiC;AACtCA,QAAM1B,aAAN,GAAsB,UAAUoB,EAAV,EAAcR,IAAd,EAAoB;AACxC,WAAOZ,cAAc,IAAd,EAAoBoB,EAApB,EAAwBR,IAAxB,CAAP;AACD,GAFD;;AAIAc,QAAMzB,cAAN,GAAuB,UAAUmB,EAAV,EAAcR,IAAd,EAAoB;AACzC,WAAOX,eAAe,IAAf,EAAqBmB,EAArB,EAAyBR,IAAzB,CAAP;AACD,GAFD;;AAIA,SAAOc,KAAP;AACD;;kBAEcxB,gB","file":"save-levelgraph.js","sourcesContent":["const levelup = require('levelup')\nconst levelgraph = require('levelgraph')\nconst jsonld = require('levelgraph-jsonld')\nconst promisify = require('./promisify')\n\nconst defaultOpts = {\n  dbPath: './gundb',\n  base: 'http://gun.io/base'\n}\n\nfunction buildOpts(opts) {\n  opts = Object.assign(defaultOpts, opts)\n\n  opts.levelDB = opts.levelDB || levelup(opts.dbPath)\n  opts.lvGraphDb = opts.lvGraphDb || levelgraph(opts.levelDB)\n  opts.db = opts.db || jsonld(opts.lvGraphDb, opts)\n  return opts\n}\n\nexport function createSaveToLvGraph(_opts) {\n  let dbOptions = buildOpts(_opts)\n\n  const saveToLvGraph = function (jsonld, cb, opts) {\n    opts = Object.assign(dbOptions, opts)\n    const db = opts.db\n    if (!db) {\n      throw new Error('saveToLvGraph: missing db option')\n    }\n    db.jsonld.put(jsonld, cb, opts)\n  }\n\n  return {\n    dbGet: dbOptions.db.jsonld.get,\n    dbOptions,\n    saveToLvGraph\n  }\n}\n\nexport function saveToLvGraph(jsonld, cb, opts) {\n  opts = Object.assign(defaultOpts, opts)\n  opts = buildOpts(opts)\n\n  const db = opts.db\n  if (!db) {\n    throw new Error('saveToLvGraph: missing db option')\n  }\n  db.jsonld.put(jsonld, cb, opts)\n}\n\nexport function $saveToLvGraph(jsonld, cb, opts) {\n  return promisify(saveToJsonLd, jsonld, opts)\n}\n\nexport function addSaveToLvGraph(chain) {\n  chain.saveToLvGraph = function (cb, opts) {\n    return saveToLvGraph(this, cb, opts)\n  }\n\n  chain.$saveToLvGraph = function (cb, opts) {\n    return $saveToLvGraph(this, cb, opts)\n  }\n\n  return chain\n}\n\nexport default addSaveToLvGraph"]}